(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-678fd8e5"],{"00fb":function(t,e,n){"use strict";var a={name:"BasicField"},n=n("2877"),a=Object(n.a)(a,function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"field"},[t._t("default")],2)},[],!1,null,null,null);e.a=a.exports},"39ec":function(t,e,n){"use strict";var a=n("464f"),i={name:"Form",props:{formId:{type:String,default:""},validateRule:{type:Object,default:null},successCallback:{type:Function,default:null}},mounted:function(){var t=this;this.validateRule&&this.$nextTick(function(){a.a.init(t.formId,t.validateRule,t.successCallback)})},methods:{validaForm:function(){a.a.validateForm(this.formId)}}},n=n("2877"),i=Object(n.a)(i,function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("form",{staticClass:"ui form",attrs:{id:t.formId}},[e("div",{staticClass:"ui stacked segment"},[t._t("default")],2),e("div",{staticClass:"ui error message"})])},[],!1,null,null,null);e.a=i.exports},"464f":function(t,r,u){"use strict";(function(a){u.d(r,"a",function(){return n});var t=u("d4ec"),e=u("bee2"),n=(Object(e.a)(i,null,[{key:"validateForm",value:function(t){t=a("#".concat(t));return t.form("validate form"),t.form("is valid")}},{key:"init",value:function(t,e,n){a("#".concat(t)).form({transition:"slide down",fields:e,onSuccess:function(){return n&&n(),!1}})}},{key:"notEmptyRule",value:function(t){return this._getTypeAndPrompt("empty","".concat(t,"不能为空"))}},{key:"_getRules",value:function(){return{rules:0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]}}},{key:"_getTypeAndPrompt",value:function(t,e){return{type:t,prompt:e}}},{key:"usernameRules",get:function(){return this._getRules([this._getTypeAndPrompt("minLength[4]","用户名不能少于4个字符"),this._getTypeAndPrompt("maxLength[16]","用户名不能多于16个字符")])}},{key:"passwordRules",get:function(){return this._getRules([this._getTypeAndPrompt("minLength[6]","密码不能少于6个字符"),this._getTypeAndPrompt("maxLength[32]","密码不能多于32个字符")])}},{key:"repeatPasswordRules",get:function(){return this._getRules([this._getTypeAndPrompt("match[password]","重复输入的密码与密码不一致")])}},{key:"nicknameRules",get:function(){return this._getRules([this._getTypeAndPrompt("minLength[4]","昵称不能少于4个字符"),this._getTypeAndPrompt("maxLength[32]","昵称不能多于32个字符")])}},{key:"captchaRules",get:function(){return this._getRules([this._getTypeAndPrompt("exactLength[4]","验证码的长度必须为4位")])}},{key:"raceTitleRules",get:function(){return this._getRules([this._getTypeAndPrompt("minLength[4]","竞赛标题不能少于4个字符"),this._getTypeAndPrompt("maxLength[64]","竞赛标题不能多于64个字符")])}},{key:"raceDescriptionRules",get:function(){return this._getRules([this._getTypeAndPrompt("maxLength[512]","竞赛描述不能多于512个字符")])}}]),i);function i(){Object(t.a)(this,i)}}).call(this,u("1157"))},"5ae3":function(t,e,n){"use strict";var a=n("c967");n.n(a).a},"9ed6":function(t,e,n){"use strict";n.r(e);var r=(n("ac1f"),n("5319"),n("96cf"),n("1da1")),u=n("4337"),s="/security",a=n("464f"),i={name:"CaptchaInput",props:{uuid:{type:String,required:!0},name:{default:"code",type:String}},data:function(){return{captchaBaseUrl:"",input:""}},methods:{getCaptchaImage:function(){var a=this;return Object(r.a)(regeneratorRuntime.mark(function t(){var e,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a.focusIfRefreshOldCaptcha(),a.clearInput(),t.next=4,Object(u.a)("".concat(s,"/captchaImage"));case 4:n=t.sent,e=n.success,n=n.data,e&&(a.captchaBaseUrl="data:image/gif;base64,".concat(n.captchaBase64),a.$emit("update:uuid",n.uuid));case 8:case"end":return t.stop()}},t)}))()},focusIfRefreshOldCaptcha:function(){""!==this.uuid&&this.$refs.captchaInput.focus()},clearInput:function(){this.$emit("update:uuid",""),this.input=""}}},c=(n("5ae3"),n("2877")),o=Object(c.a)(i,function(){var e=this,t=e.$createElement,t=e._self._c||t;return t("div",{staticClass:"ui left icon input"},[t("i",{staticClass:"shield alternate icon"}),t("input",{directives:[{name:"model",rawName:"v-model",value:e.input,expression:"input"}],ref:"captchaInput",attrs:{name:"code",placeholder:"验证码",type:"text"},domProps:{value:e.input},on:{input:[function(t){t.target.composing||(e.input=t.target.value)},function(t){return e.$emit("input",t.target.value)}]}}),t("img",{staticClass:"m-margin-l captcha",attrs:{src:e.captchaBaseUrl},on:{click:e.getCaptchaImage}})])},[],!1,null,"5715e9e5",null).exports,l=n("39ec"),d=n("00fb"),i={name:"LeftIconField",components:{BasicField:d.a},props:{icon:{type:String,required:!0}}},i={name:"LeftIconInputField",components:{LeftIconField:Object(c.a)(i,function(){var t=this.$createElement,t=this._self._c||t;return t("BasicField",[t("div",{staticClass:"ui left icon input"},[t("i",{staticClass:"icon",class:this.icon}),this._t("default")],2)])},[],!1,null,null,null).exports},props:{icon:{type:String,required:!0},data:{type:String,required:!0},name:{type:String,default:""},type:{type:String,default:"text"},placeholder:{type:String,default:""}}},i=Object(c.a)(i,function(){var e=this,t=e.$createElement,t=e._self._c||t;return t("LeftIconField",{attrs:{icon:e.icon}},[t("input",{attrs:{name:e.name,type:e.type,placeholder:e.placeholder},domProps:{value:e.data},on:{input:function(t){return e.$emit("update:data",t.target.value)}}})])},[],!1,null,null,null).exports,o={name:"Login",components:{BasicField:d.a,LeftIconInputField:i,Form:l.a,CaptchaInput:o},data:function(){return{loginForm:{username:"",password:"",code:"",uuid:""},captchaBaseUrl:""}},mounted:function(){this.refreshCaptcha()},methods:{submitLogin:function(){var i=this;return Object(r.a)(regeneratorRuntime.mark(function t(){var n,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e=i.loginForm,Object(u.b)("".concat(s,"/login"),e);case 2:if(a=t.sent,n=a.success,a=a.data,n)return i.$store.commit("SET_USER",a.user),i.$store.commit("SET_TOKEN",a.token),t.next=10,i.$router.replace("/");t.next=12;break;case 10:t.next=13;break;case 12:i.refreshCaptcha();case 13:case"end":return t.stop()}var e},t)}))()},refreshCaptcha:function(){this.$refs.loginCaptcha.getCaptchaImage()},validateRule:function(){return{username:a.a.usernameRules,password:a.a.passwordRules,code:a.a.captchaRules}},validaLoginForm:function(){this.$refs.loginForm.validaForm()}}},o=(n("eb92"),Object(c.a)(o,function(){var e=this,t=e.$createElement,t=e._self._c||t;return t("div",{staticClass:"ui middle aligned center aligned grid fullHeight"},[t("div",{staticClass:"column"},[t("h2",{staticClass:"ui teal header"},[e._v(" 登录你的账号 ")]),t("Form",{ref:"loginForm",staticClass:"large",attrs:{"form-id":"loginForm","validate-rule":e.validateRule(),"success-callback":e.submitLogin}},[t("LeftIconInputField",{attrs:{icon:"user",data:e.loginForm.username,placeholder:"用户名",name:"username"},on:{"update:data":function(t){return e.$set(e.loginForm,"username",t)}}}),t("LeftIconInputField",{attrs:{icon:"lock",data:e.loginForm.password,placeholder:"密码",name:"password",type:"password"},on:{"update:data":function(t){return e.$set(e.loginForm,"password",t)}}}),t("BasicField",[t("CaptchaInput",{ref:"loginCaptcha",attrs:{uuid:e.loginForm.uuid},on:{"update:uuid":function(t){return e.$set(e.loginForm,"uuid",t)}},model:{value:e.loginForm.code,callback:function(t){e.$set(e.loginForm,"code",t)},expression:"loginForm.code"}})],1),t("div",{staticClass:"ui fluid large teal button",on:{click:e.validaLoginForm}},[e._v("登录")])],1)],1)])},[],!1,null,"a01592d4",null));e.default=o.exports},bee2:function(t,e,n){"use strict";function a(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function i(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}n.d(e,"a",function(){return i}),n("7a82")},c967:function(t,e,n){},d4ec:function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return a})},eb92:function(t,e,n){"use strict";var a=n("fd52");n.n(a).a},fd52:function(t,e,n){}}]);